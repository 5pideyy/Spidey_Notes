
- List Current Processes
```shell-session
ps aux | grep root
```
grep for higher priv users

- Sudo - List User's Privileges
```shell-session
sudo -l
```
- Cron Jobs
```shell-session
ls -la /etc/cron.daily/
```
- Unmounted File Systems and Additional Drives
```shell-session
lsblk
```
- SETUID and SETGID Permissions:
```
find / -perm -u=s -type f 2>/dev/null
```

```
find / -perm /6000 2>/dev/null

```
- Writeable Directories
```shell-session
find / -path /proc -prune -o -type d -perm -o+w 2>/dev/null
```
- Writeable files
```shell-session
find / -path /proc -prune -o -type f -perm -o+w 2>/dev/null
```


## Information Gathering

- OS Information
```shell-session
cat /etc/os-release
```

- Path variable misconf [PATH Misconf](https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/)
```shell-session
echo $PATH
```

- env variable
```
env
```

- kernel version

```
cat /proc/version
```

```
uname -a
```

- information about cpu

```
lscpu
```

- Available Shell

```
cat /etc/shells
```

used to spwan shells 

- Drives or share in filesystem 
```
lsblk
```

mounted dive contains entries in `mountpoint`

- information about mount
```
/etc/fstab
```
it contains information about mount (automatically/manual) when system boots up


- using internal DNS?

```
┌──(pradyun㉿kali)-[~]
└─$ cat /etc/resolv.conf            
# Generated by NetworkManager
search kct.ac.in
nameserver 172.16.15.200
nameserver 4.2.2.2

┌──(pradyun㉿kali)-[~]
└─$ nslookup 172.16.15.200 
200.15.16.172.in-addr.arpa      name = kctmaindns.kct.local.
```

- List of users
```shell-session
cat /etc/passwd | cut -f1 -d:
```

- List of Group

```shell-session
cat /etc/group
```

- users in Group
```shell-session
getent group sudo
```

- Mounted File Systems
```shell-session
df -h
```

- unmounted File systems

```shell-session
cat /etc/fstab | grep -v "#" | column -t
```

- Hidden Files
```shell-session
find / -type f -name ".*" -exec ls -l {} \; 2>/dev/null | grep htb-student
```
htb-student is user

- Hidden Folder

```shell-session
find / -type d -name ".*" -ls 2>/dev/null
```

- Temporary Files

```shell-session
ls -l /tmp /var/tmp /dev/shm
```


## Internal Enumeration & Services

- last login user information
```shell-session
lastlog
```

- currently who logged in with us
```
w
```

```
finger
```

- Finding History Files

```shell-session
find / -type f \( -name *_hist -o -name *_history \) -exec ls -l {} \; 2>/dev/null
```

- Configuration Files

```shell-session
find / -type f \( -name *.conf -o -name *.config \) -exec ls -l {} \; 2>/dev/null
```

- Scripts

```shell-session
find / -type f -name "*.sh" 2>/dev/null | grep -v "src\|snap\|share"
```

